<!DOCTYPE html>
<!-- saved from url=(0144)file:///C:/Users/simon/OneDrive/Documents/Career/Career%20growth/Mass%20Affluent%20Wealth/SMSF%20chatbot%20prototype/content/smsf_frontend.html? -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>SMSF Edu Chat (PoC)</title>
<style>
  body { font-family: system-ui, Arial, sans-serif; margin: 32px; max-width: 720px; }
  h1 { margin: 0 0 8px; }
  #log { border: 1px solid #ddd; padding: 12px; border-radius: 8px; height: 360px; overflow:auto; background:#fafafa; }
  .msg { margin: 8px 0; }
  .you { font-weight: 600; }
  .bot { white-space: pre-wrap; }
  #form { display: flex; gap: 8px; margin-top: 12px; }
  #q { flex: 1; padding: 10px; border: 1px solid #ccc; border-radius: 8px; }
  button { padding: 10px 16px; border-radius: 8px; border: 1px solid #999; background: #fff; cursor: pointer; }
  button:disabled { opacity: .6; cursor: not-allowed; }
  small { color: #666; }
</style>

</head><body><h1>SMSF Edu Chat</h1>
<small>Educational only — not financial advice.</small>

<div id="log" aria-live="polite"></div>

<form id="form">
  <input id="q" type="text" placeholder="Type a question… e.g., What is an SMSF?" autocomplete="off">
  <button id="send" type="submit">Ask</button>
</form>

<script>
  const API_URL = "https://8ccun2hmbi.execute-api.ap-southeast-2.amazonaws.com/prod/prompt";
  const log = document.getElementById('log');
  const form = document.getElementById('form');
  const q = document.getElementById('q');
  const send = document.getElementById('send');

  function addLine(text, who='you') {
    const div = document.createElement('div');
    div.className = 'msg ' + who;
    div.textContent = (who === 'you' ? 'You: ' : 'Bot: ') + text;
    if (who === 'bot') div.className = 'msg bot';
    log.appendChild(div);
    log.scrollTop = log.scrollHeight;
  }

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const text = q.value.trim();
    if (!text) return;
    addLine(text, 'you');
    q.value = '';
    send.disabled = true;

    try {
      const res = await fetch(API_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ message: text })
      });
      const data = await res.json();
      if (!res.ok) {
        addLine(`Error ${res.status}: ${data?.error || 'Unknown error'}`, 'bot');
      } else {
        addLine(data.answer || '(No answer field returned)', 'bot');
        if (Array.isArray(data.sources) && data.sources.length) {
          const s = data.sources.map(s => `${s.title || s.id || 'source'} - ${s.url || ''}`).join('\n');
          addLine("Sources:\n" + s, 'bot');
        }
      }
    } catch (err) {
      addLine('Network error: ' + (err?.message || err), 'bot');
    } finally {
      send.disabled = false;
    }
  });
</script>

</body></html>